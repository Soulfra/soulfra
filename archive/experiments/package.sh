#!/bin/bash
# Packaging script for soulfra-simple
# Auto-generated by templates_lib/bash.py

set -e
set -u

PACKAGE_NAME="soulfra-simple"
VERSION="1.0.0"
OUTPUT_DIR="dist/"
ARCHIVE_NAME="${PACKAGE_NAME}-${VERSION}.tar.gz"

echo "ðŸ“¦ Packaging ${PACKAGE_NAME} v${VERSION}..."

# Create output directory
mkdir -p "$OUTPUT_DIR"

# Create temporary staging directory
STAGING_DIR=$(mktemp -d)
echo "  Staging directory: $STAGING_DIR"

# Copy files to staging
echo "  Copying files..."
for item in *.py templates/ migrations/ static/ cringeproof.py train_binary_classifier.py templates_lib/; do
    if [ -e "$item" ]; then
        cp -r "$item" "$STAGING_DIR/"
        echo "    âœ“ $item"
    fi
done

# Create tarball
echo "  Creating archive..."
cd "$STAGING_DIR"
tar -czf "$ARCHIVE_NAME" ./*
mv "$ARCHIVE_NAME" "$OLDPWD/$OUTPUT_DIR/"
cd "$OLDPWD"

# Cleanup
rm -rf "$STAGING_DIR"

echo "âœ… Package created: $OUTPUT_DIR/$ARCHIVE_NAME"
echo ""
echo "Package contents:"
tar -tzf "$OUTPUT_DIR/$ARCHIVE_NAME" | head -20
