name: Setup GitHub Secrets

on:
  workflow_dispatch:

jobs:
  check-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Check Required Secrets
        run: |
          echo "üîê Checking GitHub Secrets Configuration..."
          echo ""
          echo "Required Secrets for Soulfra Gateway:"
          echo ""
          echo "‚úÖ STRIPE_LIVE_PUBLISHABLE_KEY - Stripe live publishable key (pk_live_...)"
          echo "‚úÖ STRIPE_LIVE_SECRET_KEY - Stripe live secret key (sk_live_...)"
          echo "‚úÖ STRIPE_WEBHOOK_SECRET - Stripe webhook secret (whsec_...)"
          echo "‚úÖ JWT_SECRET - Master authentication secret (generate strong random string)"
          echo "‚úÖ GITHUB_TOKEN - GitHub personal access token (already provided by Actions)"
          echo ""
          echo "Optional Secrets (for Phase 3):"
          echo "üìß TWILIO_ACCOUNT_SID - Twilio account SID for SMS"
          echo "üìß TWILIO_AUTH_TOKEN - Twilio auth token"
          echo "üìß TWILIO_PHONE_NUMBER - Twilio phone number (+1...)"
          echo "üìß SENDGRID_API_KEY - SendGrid API key for emails"
          echo ""
          echo "üîí Current Status:"

          if [ -n "${{ secrets.STRIPE_LIVE_PUBLISHABLE_KEY }}" ]; then
            echo "‚úÖ STRIPE_LIVE_PUBLISHABLE_KEY: Configured"
          else
            echo "‚ùå STRIPE_LIVE_PUBLISHABLE_KEY: Missing"
          fi

          if [ -n "${{ secrets.STRIPE_LIVE_SECRET_KEY }}" ]; then
            echo "‚úÖ STRIPE_LIVE_SECRET_KEY: Configured"
          else
            echo "‚ùå STRIPE_LIVE_SECRET_KEY: Missing"
          fi

          if [ -n "${{ secrets.STRIPE_WEBHOOK_SECRET }}" ]; then
            echo "‚úÖ STRIPE_WEBHOOK_SECRET: Configured"
          else
            echo "‚ùå STRIPE_WEBHOOK_SECRET: Missing"
          fi

          if [ -n "${{ secrets.JWT_SECRET }}" ]; then
            echo "‚úÖ JWT_SECRET: Configured"
          else
            echo "‚ùå JWT_SECRET: Missing"
          fi

          echo ""
          echo "üìñ How to Add Secrets:"
          echo "1. Go to: https://github.com/${{ github.repository }}/settings/secrets/actions"
          echo "2. Click 'New repository secret'"
          echo "3. Add each secret listed above"
          echo ""
          echo "üîë Where to Get Keys:"
          echo "- Stripe keys: https://dashboard.stripe.com/apikeys"
          echo "- Stripe webhook: https://dashboard.stripe.com/webhooks"
          echo "- JWT secret: Generate with: openssl rand -hex 32"
          echo ""

      - name: Generate JWT Secret
        run: |
          echo "üîê Generated JWT Secret (save this in GitHub Secrets as JWT_SECRET):"
          openssl rand -hex 32

      - name: Test Configuration
        run: |
          echo "‚úÖ Secrets setup check complete!"
          echo ""
          echo "Next steps:"
          echo "1. Add missing secrets to GitHub"
          echo "2. Update DNS records (see DNS_SETUP.md)"
          echo "3. Deploy gateway control panel"
