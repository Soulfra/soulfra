{% extends "base.html" %}

{% block title %}{{ content.title }} - Generated Content{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6">
    <!-- Header with Verification Status -->
    <div class="{% if verified %}bg-gradient-to-r from-green-500 to-emerald-600{% else %}bg-gradient-to-r from-orange-500 to-red-600{% endif %} rounded-xl shadow-2xl p-8 mb-6 text-white">
        <div class="flex items-start justify-between">
            <div class="flex-1">
                <h1 class="text-3xl font-bold mb-2">{{ content.title }}</h1>
                <p class="text-sm opacity-90">{{ content.content_type | title }} Â· Created {{ content.created_at }}</p>
            </div>
            <div class="text-right">
                {% if verified %}
                <div class="text-4xl mb-1">âœ…</div>
                <div class="font-bold">VERIFIED</div>
                <div class="text-xs opacity-90">100% Valid</div>
                {% else %}
                <div class="text-4xl mb-1">âš ï¸</div>
                <div class="font-bold">UNVERIFIED</div>
                <div class="text-xs opacity-90">Check failed</div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Verification Details -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">ğŸ” Verification Details</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
            <div class="flex items-center gap-2">
                <span class="text-2xl">{{ 'âœ…' if verification.hash_matches else 'âŒ' }}</span>
                <div>
                    <div class="font-medium text-gray-700">Hash Matches</div>
                    <div class="text-gray-500">Content unchanged</div>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <span class="text-2xl">{{ 'âœ…' if verification.upc_valid else 'âŒ' }}</span>
                <div>
                    <div class="font-medium text-gray-700">UPC Valid</div>
                    <div class="text-gray-500">Checksum correct</div>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <span class="text-2xl">{{ 'âœ…' if verification.upc_matches_hash else 'âŒ' }}</span>
                <div>
                    <div class="font-medium text-gray-700">UPC Matches Hash</div>
                    <div class="text-gray-500">Deterministically generated</div>
                </div>
            </div>
        </div>
    </div>

    <!-- All Cross-Reference Codes -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">ğŸ·ï¸ Cross-Reference Codes</h2>

        <!-- Content Hash -->
        <div class="mb-4 pb-4 border-b border-gray-200">
            <div class="flex items-center justify-between mb-2">
                <span class="font-medium text-gray-700">SHA-256 Content Hash</span>
                <button onclick="copyToClipboard('{{ content.content_hash }}')" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded transition">Copy</button>
            </div>
            <code class="block bg-gray-50 p-3 rounded text-xs font-mono break-all">{{ content.content_hash }}</code>
        </div>

        <!-- UPC-12 -->
        <div class="mb-4 pb-4 border-b border-gray-200">
            <div class="flex items-center justify-between mb-2">
                <span class="font-medium text-gray-700">UPC-12 Barcode</span>
                <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded">{{ 'âœ“ Valid' if content.upc_valid else 'âœ— Invalid' }}</span>
            </div>
            <div class="text-2xl font-mono font-bold tracking-wider">{{ content.upc_code }}</div>
            <div class="text-xs text-gray-500 mt-1">Deterministically generated from content hash</div>
        </div>

        <!-- QR Code -->
        <div class="mb-4 pb-4 border-b border-gray-200">
            <div class="font-medium text-gray-700 mb-2">Vanity QR Code</div>
            <a href="{{ content.qr_vanity_url }}" class="text-indigo-600 hover:underline font-mono text-sm">{{ content.qr_vanity_url }}</a>
            <div class="text-xs text-gray-500 mt-1">Short code: {{ content.qr_short_code }}</div>
        </div>

        <!-- Affiliate Code -->
        <div>
            <div class="font-medium text-gray-700 mb-2">Affiliate Tracking Code</div>
            <a href="https://soulfra.com/aff/{{ content.affiliate_code }}" class="text-purple-600 hover:underline font-mono text-sm">{{ content.affiliate_code }}</a>
            <div class="text-xs text-gray-500 mt-1">Track clicks and conversions</div>
        </div>
    </div>

    <!-- Content Preview -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">ğŸ“„ Content</h2>

        {% if content.content_type == 'hello_world' and metadata.code %}
        <div class="mb-4">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-lg">ğŸ’»</span>
                <span class="font-medium text-gray-700">{{ metadata.language | title }} Code</span>
            </div>
            <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto"><code>{{ metadata.code }}</code></pre>
        </div>
        {% endif %}

        <div class="prose max-w-none">
            {{ content.description | default(content.content[:200] + '...') }}
        </div>
    </div>

    <!-- Actions -->
    <div class="flex gap-4">
        <a href="{{ url_for('generator.generate_interface') }}" class="flex-1 text-center px-6 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition">
            â† Back to Generator
        </a>
        <button onclick="window.print()" class="px-6 py-3 bg-gray-200 text-gray-800 font-bold rounded-lg hover:bg-gray-300 transition">
            ğŸ–¨ï¸ Print
        </button>
    </div>
</div>

<script>
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        alert('Copied to clipboard!');
    });
}
</script>
{% endblock %}
